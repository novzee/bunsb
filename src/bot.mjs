import TeleBot from 'telebot';
import schedule from 'node-schedule';

const bot = new TeleBot(process.env.TELEGRAM_BOT_TOKEN);

// ĞœĞ°ÑÑĞ¸Ğ² Ğ´Ğ»Ñ Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ chatId Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹
const users = new Set();

// ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ /start
bot.on(/\/start/, async (msg) => {
  const chatId = msg.chat.id;
  const firstName = msg.from.first_name || 'there';

  // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ chatId Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
  users.add(chatId);

  // ĞŸĞµÑ€Ğ²Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ñ ĞºĞ½Ğ¾Ğ¿ĞºĞ°Ğ¼Ğ¸
  const firstMessage = `ĞŸÑ€Ğ¸Ğ²ĞµÑ‚, ${firstName}! ğŸ‰\n\nĞœÑ‹ Ñ€Ğ°Ğ´Ñ‹, Ñ‡Ñ‚Ğ¾ Ñ‚Ñ‹ Ñ€ĞµÑˆĞ¸Ğ» Ğ¿Ğ¾Ğ¿Ñ€Ğ¾Ğ±Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ½Ğ°ÑˆÑƒ Ğ½Ğ¾Ğ²ÑƒÑ Ğ¸Ğ³Ñ€Ñƒ! ĞĞ½Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ° ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ Ğ´Ğ»Ñ Ñ‚Ğ¾Ğ³Ğ¾, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‡ÑŒ Ñ‚ĞµĞ±Ğµ Ğ½Ğ°ÑƒÑ‡Ğ¸Ñ‚ÑŒÑÑ Ñ„Ğ¸Ğ½Ğ°Ğ½ÑĞ¾Ğ²Ğ¾Ğ¹ Ğ³Ñ€Ğ°Ğ¼Ğ¾Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ² ÑƒĞ²Ğ»ĞµĞºĞ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¼ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ Ğ³Ğ¾Ğ½ĞºĞ¸. Ğ§ĞµĞ¼ Ğ±Ñ‹ÑÑ‚Ñ€ĞµĞµ Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½ĞµĞµ Ñ‚Ñ‹ Ğ±ÑƒĞ´ĞµÑˆÑŒ Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°Ñ‚ÑŒ Ğ½Ğ° Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹, Ñ‚ĞµĞ¼ Ğ±Ñ‹ÑÑ‚Ñ€ĞµĞµ Ğ¿Ğ¾ĞµĞ´ĞµÑ‚ Ñ‚Ğ²Ğ¾Ğ¹ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒ!\n\nĞ§Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ Ğ¸Ğ³Ñ€Ñƒ, Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ Ğ½Ğ°Ğ¶Ğ¼Ğ¸ Ğ½Ğ° ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ½Ğ¸Ğ¶Ğµ. Ğ£Ğ´Ğ°Ñ‡Ğ¸ Ğ¸ Ğ¿Ñ€Ğ¸ÑÑ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ¿ÑƒÑ‚ĞµÑˆĞµÑÑ‚Ğ²Ğ¸Ñ Ğ² Ğ¼Ğ¸Ñ€ Ñ„Ğ¸Ğ½Ğ°Ğ½ÑĞ¾Ğ²! ğŸš€ğŸ’°`;

  await bot.sendMessage(chatId, firstMessage, {
    parseMode: 'Markdown',
    replyMarkup: bot.keyboard([
      ['ğŸš€ ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ¸Ğ³Ñ€Ñƒ', 'ğŸ“š ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ¸Ğ³Ñ€Ñ‹']
    ], { resize: true })
  });

  // Ğ’Ñ‚Ğ¾Ñ€Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ñ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ¾Ğ¹ Ğ² 30 ÑĞµĞºÑƒĞ½Ğ´
  setTimeout(async () => {
    const secondMessage = `ğŸ“š *ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ Ğ˜Ğ“Ğ Ğ«*\n\nĞ‘Ğ»Ğ°Ğ³Ğ¾Ğ´Ğ°Ñ€Ğ¸Ğ¼ Ñ‚ĞµĞ±Ñ Ğ·Ğ° Ğ¿Ñ€Ğ¾ÑĞ²Ğ»ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑ!\nĞ¤Ğ¸Ğ½Ğ“Ğ¾Ğ½ĞºĞ¸ - Ğ¸Ğ³Ñ€Ğ° Ğ½Ğ° Ğ±Ğ°Ğ·Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ¢ĞµĞ»ĞµĞ³Ñ€Ğ°Ğ¼. Ğ§Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿Ñ€Ğ¸Ğ½ÑÑ‚ÑŒ ÑƒÑ‡Ğ°ÑÑ‚Ğ¸Ğµ Ğ½Ğµ Ğ½ÑƒĞ¶Ğ½Ğ¾ ÑĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ¸Ğ»Ğ¸ Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¸Ñ‚ÑŒ Ğ½Ğ° Ğ´Ñ€ÑƒĞ³Ğ¸Ğµ ÑĞ°Ğ¹Ñ‚Ñ‹ - Ğ²ÑÑ‘ Ğ»ĞµĞ³ĞºĞ¾ Ğ¸ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾! ğŸš€\n\nĞ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ Ğ¸Ğ³Ñ€Ñ‹ Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑ‚ÑÑ Ğ² Ğ³Ğ»Ğ°Ğ²Ğ½Ğ¾Ğ¼ Ğ¼ĞµĞ½Ñ, Ğ·Ğ´ĞµÑÑŒ Ñ‚Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑˆÑŒ Ğ¿ĞµÑ€ĞµĞ¹Ñ‚Ğ¸ Ğ² Ğ¾Ğ´Ğ¸Ğ½ Ğ¸Ğ· 3 Ñ€Ğ°Ğ·Ğ´ĞµĞ»Ğ¾Ğ²:\n1. ĞšĞ°Ñ€Ñ‚Ğ° ğŸ—º\n2. Ğ“Ğ°Ñ€Ğ°Ğ¶ ğŸ \n3. Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ğ»Ğ¸Ğ´ĞµÑ€Ğ¾Ğ² ğŸ…\n\nğŸ“*ĞšĞ°Ñ€Ñ‚Ğ°* â€“ ĞºĞ»ÑÑ‡ĞµĞ²Ğ°Ñ Ñ‚Ğ¾Ñ‡ĞºĞ°, Ñ ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğ¹ Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑ‚ÑÑ Ğ»ÑĞ±Ğ¾Ğ¹ Ğ·Ğ°ĞµĞ·Ğ´ Ğ² Ğ¤Ğ¸Ğ½Ğ“Ğ¾Ğ½ĞºĞ°Ñ…! Ğ’Ñ‹Ğ±Ğ¸Ñ€Ğ°Ğ¹ Ñ€Ğ°Ğ¹Ğ¾Ğ½ Ğ¸ Ğ¿Ğ¾Ğ³Ñ€ÑƒĞ¶Ğ°Ğ¹ÑÑ Ğ² Ğ¼Ğ¸Ñ€ Ñ„Ğ¸Ğ½Ğ°Ğ½ÑĞ¾Ğ²Ğ¾Ğ¹ Ğ³Ñ€Ğ°Ğ¼Ğ¾Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸! Ğ”Ğ°Ğ»ÑŒÑˆĞµ Ñ‚ĞµĞ±Ñ Ğ¶Ğ´Ñ‘Ñ‚ Ğ½ĞµĞ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹ Ñ‚ĞµĞ¾Ñ€ĞµÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ±Ğ»Ğ¾Ğº Ñ Ğ¿Ğ¾Ğ»ĞµĞ·Ğ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸ĞµĞ¹, Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ğ¾ÑĞ»Ğµ Ğ½ĞµĞ³Ğ¾ Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑ‚ÑÑ Ğ½Ğ°ÑÑ‚Ğ¾ÑÑ‰Ğ°Ñ Ğ³Ğ¾Ğ½ĞºĞ°! Ğ§ĞµĞ¼ Ğ±Ñ‹ÑÑ‚Ñ€ĞµĞµ Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½ĞµĞµ Ñ‚Ñ‹ Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°ĞµÑˆÑŒ Ğ½Ğ° Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ¿Ğ¾ Ğ¿Ñ€Ğ¾Ğ¹Ğ´ĞµĞ½Ğ½Ğ¾Ğ¼Ñƒ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ñƒ, Ñ‚ĞµĞ¼ Ğ±Ñ‹ÑÑ‚Ñ€ĞµĞµ ĞµĞ´ĞµÑ‚ Ñ‚Ğ²Ğ¾Ğ¹ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒ! ĞšĞ°Ğ¶Ğ´Ğ°Ñ Ğ¿Ğ¾Ğ±ĞµĞ´Ğ° Ğ¿Ñ€Ğ¸Ğ½Ğ¾ÑĞ¸Ñ‚ Ğ´ĞµĞ½ĞµĞ¶Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¸Ğ· Ğ¸ Ğ¾Ñ‡ĞºĞ¸ ÑĞ»Ğ°Ğ²Ñ‹ ğŸ†\n\nğŸ“*Ğ“Ğ°Ñ€Ğ°Ğ¶* â€“ Ğ¼ĞµÑÑ‚Ğ¾, Ğ³Ğ´Ğµ Ğ½Ğ°Ñ…Ğ¾Ğ´ÑÑ‚ÑÑ Ğ²ÑĞµ Ñ‚Ğ²Ğ¾Ğ¸ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ¾Ğ±Ğ¸Ğ»Ğ¸ (Ğ²ÑÑ‘ ĞºĞ°Ğº Ğ² Ğ¶Ğ¸Ğ·Ğ½Ğ¸!). Ğ—Ğ´ĞµÑÑŒ Ñ‚Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑˆÑŒ Ğ²Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ñ‚Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ñ€Ñ‚ Ğ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ¾ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ ÑƒĞ¶Ğµ Ğ¸Ğ¼ĞµÑÑ‰Ğ¸Ğ¹ÑÑ. Ğ Ğ°ÑĞ¿Ğ¾Ñ€ÑĞ¶Ğ°Ğ¹ÑÑ ÑĞ²Ğ¾Ğ¸Ğ¼Ğ¸ ÑÑ€ĞµĞ´ÑÑ‚Ğ²Ğ°Ğ¼Ğ¸ Ñ ÑƒĞ¼Ğ¾Ğ¼!\n\nğŸ“*Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ğ»Ğ¸Ğ´ĞµÑ€Ğ¾Ğ²* â€“ Ğ·Ğ´ĞµÑÑŒ Ñ‚Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑˆÑŒ Ğ¿Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ ÑĞ²Ğ¾Ñ‘ Ğ¼ĞµÑÑ‚Ğ¾ Ğ² Ñ€ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³Ğµ, ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ñ‚ÑŒ ÑĞ²Ğ¾Ğ¸ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ñ Ñ Ğ´Ñ€ÑƒĞ·ÑŒÑĞ¼Ğ¸ Ğ¸ Ğ½Ğ°ÑĞ»Ğ°Ğ´Ğ¸Ñ‚ÑŒÑÑ ÑĞ²Ğ¾Ğ¸Ğ¼Ğ¸ Ğ¿Ğ¾Ğ±ĞµĞ´Ğ°Ğ¼Ğ¸!\n\nĞŸĞ¾ĞµÑ…Ğ°Ğ»Ğ¸? ğŸğŸ`;

    await bot.sendMessage(chatId, secondMessage, { parseMode: 'Markdown' });
  }, 30000); // Ğ—Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ° 30 ÑĞµĞºÑƒĞ½Ğ´
});

// ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ Ğ´Ğ²Ğ° Ñ‡Ğ°ÑĞ° Ğ²ÑĞµĞ¼ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼
schedule.scheduleJob('0 */2 * * *', () => {
  for (const chatId of users) {
    bot.sendMessage(chatId, 'Ğ”Ğ°Ğ²Ğ½Ğ¾ Ñ‚ĞµĞ±Ñ Ğ½Ğµ Ğ±Ñ‹Ğ»Ğ¾ Ğ² ÑƒĞ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ³Ğ¾Ğ½ĞºĞ°Ñ…! ğŸğŸ’¨');
  }
});

// Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ±Ğ¾Ñ‚Ğ°
export default bot
